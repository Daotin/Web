ç¤ºä¾‹æ–‡ä»¶æ¥åˆ° **Vueçš„ç»„ä»¶**

---



## ä¸€ã€Vueè·¯ç”±

### 1ã€ä»€ä¹ˆæ˜¯è·¯ç”±ï¼Ÿ

**åç«¯è·¯ç”±ï¼š**å¯¹äºæ™®é€šçš„ç½‘ç«™ï¼Œæ‰€æœ‰çš„è¶…é“¾æ¥éƒ½æ˜¯URLåœ°å€ï¼Œæ‰€æœ‰çš„URLåœ°å€éƒ½å¯¹åº”æœåŠ¡å™¨ä¸Šå¯¹åº”çš„èµ„æºï¼›

**å‰ç«¯è·¯ç”±ï¼š**å¯¹äºå•é¡µé¢åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œä¸»è¦é€šè¿‡URLä¸­çš„hash(#å·)æ¥å®ç°ä¸åŒé¡µé¢ä¹‹é—´çš„åˆ‡æ¢ï¼Œå¹¶ä¸ä¼šå‘åç«¯å‘é€è¯·æ±‚ã€‚åŒæ—¶ï¼Œhashæœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼šHTTPè¯·æ±‚ä¸­ä¸ä¼šåŒ…å«hashç›¸å…³çš„å†…å®¹ï¼›æ‰€ä»¥ï¼Œå•é¡µé¢ç¨‹åºä¸­çš„é¡µé¢è·³è½¬ä¸»è¦ç”¨hashå®ç°ï¼›

åœ¨å•é¡µé¢åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™ç§**é€šè¿‡hashæ”¹å˜æ¥åˆ‡æ¢é¡µé¢**çš„æ–¹å¼ï¼Œç§°ä½œå‰ç«¯è·¯ç”±ï¼ˆåŒºåˆ«äºåç«¯è·¯ç”±ï¼‰ï¼›



æ‰¿æ¥åˆ°**Vueçš„ç»„ä»¶**çš„ç¤ºä¾‹æ–‡ä»¶ï¼šğŸ‘‡

ç°åœ¨æœ‰Homeï¼ŒGoodså’ŒUserså­ç»„ä»¶ï¼Œæˆ‘ä»¬åœ¨ç‚¹å‡»è·³è½¬æŒ‰é’®çš„æ—¶å€™ï¼Œé¡µé¢é€šè¿‡`<Component :is="currentPage" />` æ”¹å˜äº†ï¼Œä½†æ˜¯åœ°å€urlæ²¡å˜ï¼Œè¿™å°±æ˜¯å•é¡µé¢åº”ç”¨ã€‚

è¿™æ ·æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯æ²¡æ³•åˆ†äº«ç»™ä»–äººï¼Œå› ä¸ºåœ°å€æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯çœ‹åˆ°çš„å†…å®¹ä¸åŒã€‚è¿˜æœ‰ä¸€ç‚¹å°±æ˜¯æ²¡æœ‰å›é€€åŠŸèƒ½ã€‚

å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŸåŠç”¨åˆ°äº†vueçš„è·¯ç”±ã€‚



### 2ã€è·¯ç”±çš„åŸºæœ¬ä½¿ç”¨

åœ¨vueä¸­ä½¿ç”¨è·¯ç”±éœ€è¦ç”¨åˆ°`vue-router`çš„æ’ä»¶ã€‚



1ã€æŒ‰ç…§vue-routeræ’ä»¶

```html
npm i vue-router -S
```

2ã€å¼•å…¥å¹¶æ³¨å…¥è·¯ç”±åˆ°vue

```js
import Router from 'vue-router'

Vue.use(Router);
```

3ã€åˆ›å»ºä¸€ä¸ªè·¯ç”±å®ä¾‹ï¼Œå‚æ•°ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªé…ç½®å¯¹è±¡ä¸­æœ‰ä¸€ä¸ªå±æ€§ï¼š`routes`ï¼Œè¡¨ç¤º **è·¯ç”±çš„åŒ¹é…è§„åˆ™**ã€‚

```js
let router = new Router({
    routes : [
        { path: '/home', component: Home }, //å½“åœ°å€ä¸º/homeæ—¶ï¼Œæ˜¾ç¤ºHomeç»„ä»¶
        { path: '/goods', component: Goods },
        { path: '/users', component: Users }
    ]
});
```

> routes å±æ€§æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸€é¡¹éƒ½æ˜¯ä¸€æ¡åŒ¹é…è§„åˆ™ã€‚
>
> æ¯ä¸ªè·¯ç”±è§„åˆ™ï¼Œéƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªè§„åˆ™å¯¹è±¡ï¼Œèº«ä¸Šï¼Œæœ‰ä¸¤ä¸ªå¿…é¡»çš„å±æ€§ï¼š
>
> `path`ï¼šè¡¨ç¤ºç›‘å¬çš„è·¯ç”±é“¾æ¥åœ°å€
>
> `component`ï¼šè¡¨ç¤ºå¦‚æœè·¯ç”±æ˜¯å‰é¢åŒ¹é…åˆ°çš„ path ï¼Œåˆ™å±•ç¤º component å±æ€§å¯¹åº”çš„é‚£ä¸ªç»„ä»¶ã€‚

4ã€å°†è·¯ç”±è§„åˆ™å¯¹è±¡routeræ³¨å†Œåˆ°vueå®ä¾‹

```js
new Vue({
  el: "#box",
  data: {},
  methods: {},
  // å°†è·¯ç”±å¯¹è±¡æ³¨å†Œåˆ°vueå®ä¾‹
  router
});
```

5ã€ä¸€æ—¦è·¯ç”±è§„åˆ™åŒ¹é…æˆåŠŸï¼Œå°±ä¼šåœ¨vue-router æä¾›çš„æ ‡ç­¾`router-view` ä¸Šæ˜¾ç¤ºå‡ºæ¥ï¼Œè¿™ä¸ªæ ‡ç­¾å°±æ˜¯åŒ¹é…è·¯ç”±æˆåŠŸåcomponentå¯¹åº”çš„ç»„ä»¶åº”è¯¥æ˜¾ç¤ºçš„ä½ç½®ã€‚

```html
<div>
    <button @click="goPage(nav.name)" v-for="nav in navs">{{nav.text}}</button>
    <router-view></router-view>
</div>
```

ç„¶åæ¥çœ‹çœ‹ç•Œé¢ï¼š

![](images/9.gif)



### 3ã€router-linkå±æ€§

æˆ‘ä»¬ä¹‹å‰çš„è¶…é“¾æ¥æ˜¯ç”±aæ ‡ç­¾ä»£æ›¿çš„ï¼Œå¦‚æœè¦è·³è½¬é‚£ä¹ˆå¹¶ä¸”æ¯æ¬¡hrefå±æ€§éƒ½è¦åŠ ä¸Š#ï¼Œè¿™æ ·å¤ªéº»çƒ¦ã€‚

vue-routerå®˜æ–¹æä¾›äº†ä¸€ä¸ª`router-link` çš„å±æ€§å¯ä»¥å®ç°è·¯ç”±çš„è·³è½¬ã€‚

```html
<!--app.html-->
<div>
    <router-link tag="button" :to="nav.name" v-for="nav in navs">{{nav.text}}</router-link>
    <router-view></router-view>
</div>
```

æˆ‘ä»¬é€šè¿‡æ£€æŸ¥å¯ä»¥çŸ¥é“ï¼Œrouter-link ä¼šé»˜è®¤æ¸²æŸ“ä¸ºä¸€ä¸ªa æ ‡ç­¾ã€‚

![](images/18.png)



ä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å…¶æ”¹å˜æˆåˆ«çš„æ ‡ç­¾ï¼Œä½¿ç”¨ `tag="span"`  å±æ€§å¯ä»¥å°†é»˜è®¤çš„aæ ‡ç­¾è½¬æ¢æˆspanæ ‡ç­¾ï¼š

```html
<router-link to="/login" tag="span">ç™»é™†</router-link>
```

![](images/19.png)



### 4ã€è·¯ç”±åµŒå¥—

æˆ‘ä»¬ç°åœ¨æƒ³åœ¨/homeè·¯å¾„ä¸‹å†æ¥å­è·¯ç”±aå’Œbï¼Œå½¢æˆåµŒå¥—è·¯ç”±/home/aæˆ–è€…/home/bå½¢å¼çš„è·¯ç”±ã€‚

![](images/30.png)

åœ¨è·¯ç”±é…ç½®è§„åˆ™æ•°ç»„ä¸­ä½¿ç”¨ `children` å±æ€§ï¼Œå®ç°å­è·¯ç”±åŠŸèƒ½ã€‚

```js
let router = new Router({
    routes: [
        // è·¯ç”±é‡å®šå‘
        { path: '/', redirect: '/home' },
        {
            path: '/home',
            component: Home,
        	// ä½¿ç”¨childrenå®ç°å­è·¯ç”±
            children: [
                { path: 'a', component: A },
                { path: 'b', component: B }
            ]
        },
        { path: '/goods', component: Goods },
        { path: '/users', component: Users }
    ]
});
```

> æ³¨æ„ï¼šå­è·¯ç”±çš„åŒ¹é…è§„åˆ™å‰é¢ä¸è¦åŠ  `/` ã€‚

ç„¶ååœ¨Homeçš„templateä¸­åŠ å…¥`<router-view></router-view>`å³å¯ã€‚

æ¥çœ‹ç°è±¡ï¼š

![](images/10.gif)

**ç»™è·¯ç”±èµ·åˆ«å**

æˆ‘ä»¬è¿˜å¯ä»¥ç»™è·¯ç”±èµ·ä¸ªåˆ«åï¼Œè¿™æ ·åœ¨æœ‰äº›è·¯ç”±ç‰¹åˆ«é•¿çš„æ—¶å€™å°±å¾ˆæ–¹ä¾¿ã€‚

èµ·åˆ«åçš„æ–¹å¼å°±æ˜¯å¾€è·¯ç”±åŒ¹é…è§„åˆ™åŠ ä¸ª`name`å±æ€§å³å¯ã€‚

```js
let router = new Router({
    routes: [
        { path: '/', redirect: '/home' },
        {
            path: '/home',
            component: Home,
            name: 'h',
            children: [
                { path: 'a', component: A, name: 'a' },
                { path: 'b', component: B, name: 'b' }
            ]
        }, //å½“åœ°å€ä¸º/homeæ—¶ï¼Œæ˜¾ç¤ºHomeç»„ä»¶
        { path: '/goods', component: Goods, name: 'g' },
        { path: '/users', component: Users, name: 'u' }
    ]
});
```

é‚£ä¹ˆæˆ‘ä»¬åœ¨ä½¿ç”¨router-linkè·³è½¬çš„æ—¶å€™ï¼Œå±æ€§toå°±æ˜¯åŠ¨æ€çš„ï¼š

```html
<router-link tag="button" :to="{name:'a'}" v-for="nav in navs">{{nav.text}}</router-link>
```

ç„¶åé‡å®šå‘redirectä¹Ÿå¯ä»¥ä½¿ç”¨nameï¼š

```js
{ path: '/', redirect: {name:'h'} },
```





### 5ã€å¤šè§†å›¾è·¯ç”±

ä¹‹å‰æˆ‘ä»¬æ˜¯åœ¨Homeä¸­åŠ è½½Aï¼ŒBç»„ä»¶ï¼Œç°åœ¨æœ‰å¦‚ä¸‹éœ€æ±‚ï¼š

![](images/31.png)

æˆ‘ä»¬åœ¨åŠ è½½/home/oneè·¯ç”±çš„æ—¶å€™ï¼Œæ²¡æœ‰åå­—çš„router-viewåŠ è½½Aç»„ä»¶ï¼Œæœ‰åå­—çš„router-viewåŠ è½½Bç»„ä»¶ï¼›

åœ¨åŠ è½½/home/twoè·¯ç”±çš„æ—¶å€™ï¼Œæ²¡æœ‰åå­—çš„router-viewåŠ è½½A2ç»„ä»¶ï¼Œæœ‰åå­—çš„router-viewåŠ è½½B2ç»„ä»¶ï¼›

è¿™ç§åœ¨Homeä¸­æ˜¾ç¤ºå¤šä¸ªrouter-viewçš„æ–¹å¼å°±å«åšå¤šè§†å›¾è·¯ç”±ã€‚



é¦–å…ˆåœ¨Homeçš„templateä¸­æ·»åŠ router-viewï¼š

```html
<div>
    <h1>é¦–é¡µ</h1>
    <router-view></router-view>
    <router-view name="b"></router-view>
</div>
```

æ¥ç€é…ç½®è·¯ç”±ï¼š

```:arrow_down:
let router = new Router({
    routes: [
        { path: '/', redirect: '/home' },
        {
            path: '/home',
            component: Home,
            name: 'h',
            children: [{
                    path: 'one',
                    components: {
                        b: B,
                        default: A
                    },
                    name: 'a'
                },
                {
                    path: 'two',
                    components: {
                        b: B2,
                        default: A2
                    },
                    name: 'b'
                }
            ]
        }, //å½“åœ°å€ä¸º/homeæ—¶ï¼Œæ˜¾ç¤ºHomeç»„ä»¶
        { path: '/goods', component: Goods, name: 'g' },
        { path: '/users', component: Users, name: 'u' }
    ]
});
```

ç”±äºä¸€ä¸ªrouter-viewè¦åŠ è½½çš„æœ‰ä¸¤ä¸ªè·¯ç”±ï¼Œæ‰€ä»¥componentå˜æˆcomponentsï¼Œå¤æ•°ï¼Œç„¶åæ˜¯ä¸ªå¯¹è±¡ï¼Œæœ‰name=bçš„å°±æ˜¯bï¼šBç»„ä»¶ï¼Œæ²¡æœ‰nameçš„å°±æ˜¯defaultï¼šAç»„ä»¶ã€‚

æ¼”ç¤ºï¼š

![](images/11.gif)





### 6ã€ç¼–ç¨‹å¼å¯¼èˆª

ç¼–ç¨‹å¼å¯¼èˆªå°±æ˜¯é€šè¿‡jsæ¥å®ç°é¡µé¢è·³è½¬ï¼ˆä¹‹å‰éƒ½æ˜¯é€šè¿‡æ ‡ç­¾router-linkæ¥è·³è½¬çš„ï¼‰ï¼Œæ¯”å¦‚å¦‚æœç”¨æˆ·ç™»å½•æˆåŠŸè·³è½¬é“é¦–é¡µï¼Œè¿™ä¸ªåˆ¤æ–­çš„åŠŸèƒ½åªèƒ½é€šè¿‡jsæ¥å®ç°ã€‚

æˆ‘åœ¨app.htmlæ·»åŠ ä¸€ä¸ªæŒ‰é’®ï¼š

```js
<button @click='goHome'>è·³è½¬åˆ°é¦–é¡µ</button>
```



ç„¶ååœ¨app.jsé‡Œé¢å®ç°ç‚¹å‡»äº‹ä»¶ï¼š

é€šè¿‡`çˆ¶ç»„ä»¶.$router.push('è·¯ç”±åœ°å€')` æˆ–è€…æ˜¯`çˆ¶ç»„ä»¶.$router.push({name:'è·¯ç”±åˆ«å'})`çš„æ–¹å¼è¿›è¡Œè·³è½¬ã€‚

```js
methods: {
    goHome() {
        this.$router.push('/home');
        this.$router.push({ name: 'h' });
    }
},
```

> `this.$router.push`å’Œ`this.$router.replace`çš„åŒºåˆ«:
>
> pushä¼šä¿ç•™è·³è½¬å‰çš„åœ°å€ï¼Œè€Œreplaceä¸ä¼šã€‚é€šè¿‡åå­—ä¹Ÿå¯ä»¥çœ‹å‡ºç«¯å€ªã€‚
>
> è¿˜æœ‰`this.$router.go(1)` æ‰§è¡Œæµè§ˆæŒ‡é’ˆçš„å‰è¿›æˆ–è€…åé€€æ¬¡æ•°ã€‚

![](images/32.png)









### 7ã€è·¯ç”±é«˜äº®æ˜¾ç¤º

æˆ‘ä»¬åœ¨ç‚¹å‡»ç™»é™†å’Œæ³¨å†Œé“¾æ¥çš„æ—¶å€™ï¼Œå¯ä¸å¯ä»¥è®©è¢«ç‚¹å‡»çš„é“¾æ¥é«˜äº®æ˜¾ç¤ºå‘¢ï¼Ÿ

**æ–¹å¼ä¸€ï¼š**

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨æ¿€æ´»çš„è·¯ç”±ä¸Šé¢ï¼Œä¼šä½¿ç”¨ä¸€ä¸ªå«åš`router-link-active` çš„ç±»ï¼Œæˆ‘ä»¬é€šè¿‡ä¿®æ”¹è¿™ä¸ªç±»çš„å±æ€§å°±å¯ä»¥è®©è¿™ä¸ªé“¾æ¥é«˜äº®æ˜¾ç¤ºäº†ã€‚

```css
.router-link-active {
  color: red;
  background-color: yellow;
}
```



**æ–¹å¼äºŒï¼š**

å¯ä»¥é€šè¿‡è·¯ç”±çš„æ„é€ é€‰é¡¹ `linkActiveClass` æ¥å…¨å±€é…ç½®éœ€è¦æ¿€æ´»çš„è·¯ç”±æ ·å¼ã€‚

```js
var routerObj = new VueRouter({
  routes: [{
    path: '/',
    redirect: '/login'
  }, {
    path: '/login',
    component: login
  }, {
    path: '/register',
    component: register
  }],
  // è‡ªå®šä¹‰è·¯ç”±æ„é€ é€‰é¡¹ linkActiveClass
  linkActiveClass: 'myClass'
});
```

![](images/21.png)





### 8ã€è·¯ç”±åˆ‡æ¢æ·»åŠ åŠ¨ç”»æ•ˆæœ

æ—¢ç„¶ router-view æ˜¯æ˜¾ç¤ºç»„ä»¶çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç»™ router-view æ¥æ·»åŠ åŠ¨ç”»æ•ˆæœï¼š

```html
<style>
  .v-enter,
  .v-leave-to {
    opacity: 0;
  }

  .v-enter-active,
  .v-leave-active {
    transition: opacity 0.5s ease;
  }
</style>

<transition mode="out-in">
  <router-view></router-view>
</transition>
```

![](images/5.gif)





### 9ã€ç»™è·¯ç”±ä¼ é€’å‚æ•°



#### æ–¹å¼ä¸€ï¼šé—®å·ä¼ å‚

æˆ‘ä»¬å¯ä»¥åœ¨è·¯ç”±ä¸­ï¼Œä½¿ç”¨æŸ¥è¯¢å­—ç¬¦ä¸²çš„æ–¹å¼ç»™è·¯ç”±ä¼ é€’å‚æ•°ã€‚

```html
<div>
    <h1>å•†å“åˆ—è¡¨é¡µé¢</h1>
    <ul>
        <router-link tag='li' :to="{name:'d',query:{gid:goods.goodsID}}" v-for="goods in list">
            <h4>å•†å“å:{{goods.name}}</h4>
            <p>ä»·æ ¼:{{goods.price}}</p>
        </router-link>
    </ul>
</div>
```

å½“ç„¶ä¸Šé¢ä¼ é€’çš„æ–¹å¼å°±ç±»ä¼¼äºä¼ ç»Ÿçš„é—®å·ä¼ å‚æ–¹å¼ã€‚æ¯”å¦‚ `/detail?gid=4` è¿™æ ·çš„æ–¹å¼ä¼ é€’ï¼Œå¦‚æœæƒ³å†™åœ¨toé‡Œé¢å°±ç”¨ä¸Šé¢çš„æ–¹å¼ã€‚



ç»™è·¯ç”±ä¼ é€’å‚æ•°åï¼Œæˆ‘ä»¬å¹¶**ä¸éœ€è¦ä¿®æ”¹è·¯ç”±åŒ¹é…è§„åˆ™**ã€‚

æˆ‘ä»¬ç»™è·¯ç”±ä¼ é€’å‚æ•°å°±æ˜¯ä¸ºäº†æ‹¿åˆ°å‚æ•°ï¼Œé‚£ä¹ˆå¦‚ä½•è·å–å‚æ•°å‘¢ï¼Ÿ

åœ¨æˆ‘ä»¬çš„ç»„ä»¶æ¨¡æ¿å¯¹è±¡é‡Œé¢ï¼Œå¯ä»¥ä½¿ç”¨`this.$route.query` çš„æ–¹å¼è·å–æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°å¯¹è±¡ã€‚

```js
export let Detail = {
    template : require("./index.html"),
    data(){
        return {
            goodsid : 0
        }
    },
    // åŠ è½½åè·å–è·¯ç”±å‚æ•°
    mounted(){
        let goodsid = this.$route.query.gid
        this.goodsid = goodsid
    }
} 
```



#### æ–¹å¼äºŒï¼šè·¯å¾„ä¼ å‚

é¦–å…ˆåœ¨è·¯ç”±åŒ¹é…è§„åˆ™ä¸­ï¼Œä½¿ç”¨å ä½ç¬¦ä»£æ›¿è·¯ç”±ä¼ é€’æ—¶çš„å‚æ•°ã€‚

path ä¸­çš„ `:newGid`è¡¨ç¤ºå¦‚æœä»¥åè·¯ç”±åé¢è·Ÿå†…å®¹äº†ï¼Œé‚£ä¹ˆå†…å®¹çš„å±æ€§å°±æ˜¯gidã€‚

```html
{path : '/detail/:newGid',component:Detail,name:"d"},
```

ç„¶ååœ¨ä¼ é€’å‚æ•°æ—¶ï¼Œå°±ä¸æ˜¯ç”¨queryäº†ï¼Œè€Œæ˜¯paramsã€‚

```html
<div>
    <h1>å•†å“åˆ—è¡¨é¡µé¢</h1>
    <ul>
        <router-link tag='li' :to="{name:'d',params:{newGid:goods.goodsID}}" v-for="goods in list">
            <h4>å•†å“å:{{goods.name}}</h4>
            <p>ä»·æ ¼:{{goods.price}}</p>
        </router-link>
    </ul>
</div>
```

è¿™æ—¶å€™ï¼Œä¼ è¿‡å»æ—¶å°±ä¸æ˜¯é—®å·çš„å½¢å¼ï¼Œè€Œæ˜¯è·¯å¾„çš„å½¢å¼ï¼Œå¦‚ï¼š`/detail/4`

è·å–çš„æ—¶å€™ä¹Ÿä¸æ˜¯queryè€Œæ˜¯paramsï¼Œ`this.$route.params`ã€‚

```js
export let Detail = {
    template : require("./index.html"),
    data(){
        return {
            goodsid : 0
        }
    },
    // åŠ è½½åè·å–è·¯ç”±å‚æ•°
    mounted(){
        let newGoodsid = this.$route.params.newGid;
        this.goodsid = newGoodsid;
    }
} 
```



#### æ–¹å¼ä¸‰ï¼šç¼–ç¨‹å¼å¯¼èˆªä¼ å‚

ä¸Šé¢çš„è·¯ç”±ä¼ å‚éƒ½æ˜¯é‡‡ç”¨toä¼ å‚ï¼Œä¹Ÿå°±æ˜¯æ ‡ç­¾ä¼ å‚ï¼Œæ€ä¹ˆä½¿ç”¨ç¼–ç¨‹å¼å¯¼èˆªä¼ å‚ï¼Ÿ

å…¶å®å’Œtoæ˜¯ä¸€æ ·çš„ï¼š

```js
this.$router.push({name:'d',query:{gid:goods.goodsID}})
this.$router.push({name:'d',params:{newGid:goods.goodsID}})
```



### 10ã€vueè·¯ç”±å®ˆå«

ä»€ä¹ˆæ˜¯è·¯ç”±å®ˆå«ï¼Ÿç®€å•æ¥è¯´å°±æ˜¯è·¯ç”±åœ¨è·³è½¬ä¹‹å‰çš„éªŒè¯ï¼Œå½“æ»¡è¶³æ¡ä»¶æ—¶æ‰ä¼šè¿›è¡Œè·³è½¬ã€‚

è·¯ç”±å®ˆå«ä¹Ÿç§°å¯¼èˆªå®ˆå«ï¼Œåˆ†ä¸º`å…¨å±€å®ˆå«`ï¼Œ`è·¯ç”±å®ˆå«`å’Œ`ç»„ä»¶å®ˆå«`



#### 10.1ã€å…¨å±€å®ˆå«

æ³¨å†Œå…¨å±€å®ˆå«åº”è¯¥åœ¨è·¯ç”±æ¨¡å—æš´éœ²å‡ºå»ä¹‹å‰å®šä¹‰ï¼Œä½¿ç”¨`router.beforeEach(function(to,from,next){})`æ¥æ³¨å†Œä¸€ä¸ªå…¨å±€å®ˆå«ã€‚

å‚æ•°ï¼š

- toï¼šä»£è¡¨ç›®æ ‡è·¯å¾„å¯¹è±¡

- fromï¼šæ¥æºè·¯å¾„å¯¹è±¡

- nextï¼šç”¨äºå†³å®šæ˜¯å¦ç»§ç»­è¿›è¡Œè·³è½¬ã€‚è¯¥æ–¹æ³•å‚æ•°æœ‰ä¸‰ç§æƒ…å†µï¼š

  å½“next()å‡½æ•°ä¸ä¼ å‚æ•°æˆ–è€…ä¼ å…¥trueçš„æ—¶å€™ åˆ™å…è®¸æ­£å¸¸è·³è½¬ï¼›

  å½“next()å‡½æ•°ä¼ å…¥falseæ—¶ ä¼šä¸­æ–­è·³è½¬(é˜»æ­¢è·³è½¬)ï¼›

  å½“next()å‡½æ•°ä¸­**ä¼ å…¥è·¯å¾„**æ—¶æˆ–è€…**å¯¹è±¡**æ—¶(æ¯”å¦‚:{name:'xxx'})åˆ™ä¼šé‡å®šå‘åˆ°æŒ‡å®šè·¯å¾„ã€‚

> å®šä¹‰åœ¨routerä¸Šçš„è·¯ç”±å®ˆå« ï¼Œå…¨å±€èŒƒå›´å†…æœ‰æ•ˆï¼Œåªè¦æœ‰è·¯å¾„è·³è½¬å°±ä¼šè§¦å‘è¯¥å®ˆå«ã€‚

å‡å¦‚æˆ‘ç°åœ¨ä»é¦–é¡µ/homeè·³è½¬åˆ°/home/twoï¼Œæ ¹æ®éšæœºæ•°æ˜¯å¦å¤§äº0.5å†³å®šæ˜¯å¦è·³è½¬ï¼š

```js
import Vue from 'vue'
import Router from 'vue-router'

import { Home } from './pages/Home'
import { Goods } from './pages/Goods'
import { Users } from './pages/Users'

import { A } from './components/A'
import { B } from './components/B'
import { A2 } from './components/A2'
import { B2 } from './components/B2'

Vue.use(Router);

let router = new Router({
    routes: [
        { path: '/', redirect: '/home' },
        {
            path: '/home',
            component: Home,
            name: 'h',
            children: [{
                    path: 'one',
                    components: {
                        b: B,
                        default: A
                    },
                    name: 'a'
                },
                {
                    path: 'two',
                    components: {
                        b: B2,
                        default: A2
                    },
                    name: 'b'
                }
            ]
        }, //å½“åœ°å€ä¸º/homeæ—¶ï¼Œæ˜¾ç¤ºHomeç»„ä»¶
        { path: '/goods', component: Goods, name: 'g' },
        { path: '/users', component: Users, name: 'u' }
    ]
});

// å½“æœ‰è·¯ç”±è·³è½¬çš„æ—¶å€™ï¼Œå°±ä¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•°
router.beforeEach(function(to, from, next) {
    console.log(to, from);
    let num = Math.random();
    console.log(num);
    next(num > 0.5 ? true : false);
});

export { router };
```



å¯ä»¥çœ‹åˆ°åªæœ‰éšæœºæ•°å¤§äº0.5çš„æ—¶å€™ï¼Œé¡µé¢æ‰çœŸæ­£å‘ç”Ÿäº†å˜åŒ–ï¼Œè·³è½¬åˆ°äº†/home/two:

![](images/12.gif)

æˆ‘ä»¬æŠŠè·¯å¾„å¯¹è±¡å±•å¼€å¯ä»¥çœ‹åˆ°æ‰€æœ‰æœ‰å…³è·¯å¾„çš„ä¿¡æ¯ï¼š

![](images/33.png)



å…¨å±€å®ˆå«è¿˜æœ‰ä¸€ä¸ª`router.afterEach(function(to,from){})` ï¼Œè¿˜æ˜¯åœ¨è·¯ç”±è·³è½¬ä¹‹å‰æ‰§è¡Œï¼Œå®ƒåœ¨å†³å®šè·³è½¬å ä»¥åŠçœŸæ­£è·³è½¬å‰æ‰§è¡Œï¼Œå…¶ä¸­å½¢å‚ to fromåŒä¸Šã€‚



#### 10.2ã€è·¯ç”±å®ˆå«

è·¯ç”±å®ˆå«å°±æ˜¯é’ˆå¯¹å•ä¸ªè·¯ç”±å¯¹è±¡é…ç½®çš„å®ˆå«ã€‚

å‡å¦‚æˆ‘åœ¨usersç»„ä»¶é…ç½®è·¯ç”±å®ˆå«ï¼Œé‚£ä¹ˆåªæœ‰è·³è½¬åˆ°usersè·¯ç”±æ—¶æ‰ä¼šè§¦å‘è¯¥å®ˆå«ï¼Œè·³è½¬åˆ°å…¶ä»–è·¯ç”±æ—¶ä¸ä¼šè§¦å‘è¯¥å®ˆå«ã€‚

è·¯ç”±å®ˆå«çš„æ³¨å†Œå†™åœ¨è·¯ç”±åŒ¹é…è§„åˆ™æ•°ç»„é‡Œé¢ï¼š

```js
let router = new Router({
    routes: [
        //...
        {
            path: '/users',
            component: Users,
            name: 'u',
            beforeEnter: (to, from, next) => {
                next(confirm('Entey Users?'));
            }
        }
    ]
});
```

ç¤ºä¾‹ï¼š

![](images/13.gif)



#### 10.3ã€ç»„ä»¶å®ˆå«

ç»„ä»¶å®ˆå«æ˜¯é’ˆå¯¹å•ä¸ªç»„ä»¶è¿›è¡Œç›‘å¬ï¼Œåœ¨è®¿é—®åˆ°è¯¥ç»„ä»¶æ—¶æ‰ä¼šè§¦å‘ã€‚

æ—¢ç„¶æ˜¯ç»„ä»¶å®ˆå«å°±å†™åœ¨ç»„ä»¶é‡Œé¢ï¼Œè¿™é‡Œä»¥è¿›å…¥Homeç»„ä»¶ä¸ºä¾‹ï¼š

```js
export let Home = {
    template: `
        <div>
            <h1>é¦–é¡µ</h1>
            <router-view></router-view>
            <router-view name="b"></router-view>
        </div>
    `,
    // åœ¨è·¯ç”±è·³è½¬æ—¶,å¦‚æœä¼šè®¿é—®åˆ°å½“å‰ç»„ä»¶,åˆ™ä¼šè§¦å‘è¯¥å®ˆå«
    beforeRouteEnter(to, from, next) {
        next(confirm('Enter Home?'));
    },
    // åœ¨è·¯ç”±è·³è½¬æ—¶,å¦‚æœç¦»å¼€å½“å‰ç»„ä»¶,åˆ™ä¼šè§¦å‘è¯¥å®ˆå«
    beforeRouteLeave (to, from, next) {
        next(confirm('Leave Home?'));
    },
    // åœ¨å½“å‰è·¯å¾„ä¸‹,å½“è·¯ç”±çš„å‚æ•°å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰ä¼šè§¦å‘è¯¥è·¯ç”±å®ˆå«
    beforeRouteUpdate(to, from, next) {
        console.log(to.params.path);
    }
}
```









### å‘½åè§†å›¾å®ç°ç»å…¸å¸ƒå±€

**ä»€ä¹ˆæ˜¯å‘½åè§†å›¾ï¼Ÿ**

æˆ‘ä»¬ä¹‹å‰çš„ router-view éƒ½æ˜¯æ²¡æœ‰åå­—çš„ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥ä¸ºå…¶æŒ‡å®šåç§°ï¼Œå°±æ˜¯å‘½åè§†å›¾ã€‚

æˆ‘ä»¬è¦å®ç°çš„ç›®æ ‡æ˜¯æ˜¾ç¤ºæ ‡é¢˜ï¼Œä¾§è¾¹æ å’Œä¸»ä½“ä¸‰éƒ¨åˆ†çš„ç»å…¸è§†å›¾ï¼Œç±»ä¼¼å¦‚ä¸‹çš„å¸ƒå±€ï¼š

![](images/23.png)



é‚£ä¹ˆæ—¢ç„¶è¦æ˜¾ç¤ºä¸‰éƒ¨åˆ†ï¼Œå°±éœ€è¦ä¸‰ä¸ª router-viewï¼Œæ€ä¹ˆè®©æ¯ä¸ª router-viewæ˜¾ç¤ºä¸åŒçš„å†…å®¹å‘¢ï¼Ÿè¿™å°±éœ€è¦ç”¨åˆ°å‘½åè§†å›¾ã€‚

è¯­æ³•ï¼š

```html
 <router-view name="view1"></router-view>
```

åªéœ€è¦æŒ‡å®šä¸€ä¸ªnameå±æ€§å³å¯ã€‚



**ç»å…¸å¸ƒå±€ç¤ºä¾‹ï¼š**

```html
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Document</title>
  <script src="./lib/vue-2.4.0.js"></script>
  <!-- 1.å¼•å…¥vue-routeræ–‡ä»¶ -->
  <script src="./lib/vue-router-3.0.1.js"></script>
  <style>
    body,
    html,
    h1,
    h2,
    h3 {
      margin: 0;
      padding: 0;
    }

    .header {
      width: 100%;
      height: 80px;
      background-color: red;
    }

    .left {
      float: left;
      width: 20%;
      height: 500px;
      background-color: green;
    }

    .right {
      float: left;
      width: 80%;
      height: 500px;
      background-color: blue;
    }
  </style>
</head>

<body>
  <div id="box">
    <router-view></router-view>
    <router-view name="leftBanner"></router-view>
    <router-view name="rightBanner"></router-view>
  </div>

  <script>
    // 3ã€åˆ›å»ºç»„ä»¶æ¨¡æ¿å¯¹è±¡
    var header = {
      template: '<h1 class="header">é¡¶éƒ¨</h1>',
    };

    var left = {
      template: '<h3 class="left">å·¦è¾¹ä¾§æ </h3>'
    };

    var right = {
      template: '<h3 class="right">å³è¾¹ä¸»ä½“</h3>',
    };

    // 2ã€åˆ›å»ºè·¯ç”±å¯¹è±¡
    var router = new VueRouter({
      routes: [{
        path: '/',
        // component è¦æ˜¾ç¤ºçš„ç»„ä»¶ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œdefaultä¸ºé»˜è®¤æ˜¾ç¤ºçš„ç»„ä»¶
        // leftBannerè¡¨ç¤ºrouter-viewæ˜¾ç¤ºåç§°ä¸ºleftBannerçš„ç»„ä»¶
        // rightBannerè¡¨ç¤ºrouter-viewæ˜¾ç¤ºåç§°ä¸ºrightBannerçš„ç»„ä»¶
        components: {
          'default': header,
          'leftBanner': left,
          'rightBanner': right
        }
      }]
    });

    var vm = new Vue({
      el: "#box",
      data: {},
      methods: {},
      // 4ã€å°†vmå®ä¾‹å’Œè·¯ç”±å¯¹è±¡è”ç³»èµ·æ¥
      router
    });
  </script>
</body>

</html>
```

> 1ã€é¦–å…ˆåˆ›å»ºä¸‰ä¸ªç»„ä»¶æ¨¡æ¿å¯¹è±¡ï¼Œåˆ†åˆ«ç”¨äºæ˜¾ç¤ºå¤´éƒ¨ï¼Œä¾§è¾¹æ ï¼Œå’Œä¸»ä½“ä¸‰ä¸ªéƒ¨åˆ†ã€‚
>
> 2ã€åœ¨åŒ¹é…è§„åˆ™é‡Œé¢ï¼Œ **component å˜æˆäº† components**ï¼Œå¹¶ä¸”å±•ç¤ºå¤šä¸ªç»„ä»¶ã€‚å…¶ä¸­ï¼š
>
> defaultä¸ºé»˜è®¤æ˜¾ç¤ºçš„ç»„ä»¶ï¼›
>
> leftBannerè¡¨ç¤ºrouter-viewæ˜¾ç¤ºåç§°ä¸ºleftBannerçš„ç»„ä»¶
>
>  rightBannerè¡¨ç¤ºrouter-viewæ˜¾ç¤ºåç§°ä¸ºrightBannerçš„ç»„ä»¶ã€‚
>
> 3ã€ä¸º router-view æŒ‡å®š components ä¸­æ˜¾ç¤ºä¸åŒç»„ä»¶çš„åç§°ã€‚
>
> 4ã€ä¸ºæ˜¾ç¤ºçš„ä¸åŒç»„ä»¶æ·»åŠ æ ·å¼ï¼Œå½¢æˆç»å…¸å¸ƒå±€æ ·å¼ã€‚



